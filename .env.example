# ================================================================
# Azure AD Configuration (Browser-based MSAL Authentication)
# ================================================================
# This application uses browser-based MSAL authentication via local server.
# NO CLIENT SECRET is required - users authenticate via browser popup.
#
# Azure AD App Requirements:
# - Platform: Single-page application (SPA)
# - Redirect URI: http://localhost:5544 (or your AUTH_SERVER_PORT)
# - API Permissions: Delegated (with admin consent)
#   - User.ReadWrite.All
#   - Directory.ReadWrite.All
#   - Organization.Read.All
#   - offline_access
# ================================================================

# Directory (tenant) ID - Find in Azure Portal > Azure AD > Overview
AZURE_TENANT_ID=your-tenant-id-here

# Application (client) ID - Find in Azure Portal > App Registrations > Your App > Overview
AZURE_CLIENT_ID=your-client-id-here

# Local authentication server port
AUTH_SERVER_PORT=5544

# NOTE: AZURE_CLIENT_SECRET is NOT needed
# This app uses browser-based authentication (same as NodeGraphApp_basicAuth)

# ================================================================
# Microsoft Graph API Configuration
# ================================================================

# Graph API endpoint (standard: https://graph.microsoft.com)
GRAPH_API_ENDPOINT=https://graph.microsoft.com

# Enable Microsoft Graph BETA endpoints for advanced features
# Beta endpoints provide:
# - Extended user attributes (employeeType, companyName, officeLocation)
# - Advanced search capabilities
# - Preview provisioning features
# Note: Beta APIs may change without notice; tool falls back to v1.0 if unavailable
USE_BETA_ENDPOINTS=true

# ================================================================
# Microsoft 365 License Configuration
# ================================================================

# Microsoft 365 License SKU ID
# Common SKU IDs:
# - Microsoft 365 E3: 05e9a617-0261-4cee-bb44-138d3ef5d965
# - Microsoft 365 E5: 06ebc4ee-1bb5-47dd-8120-11324bc54e06
# - Office 365 E3: 6fd2c87f-b296-42f0-b197-1e91e994b900
# - Microsoft 365 Business Standard: f245ecc8-75af-4f8e-b61f-27d8114de5f3
# - Microsoft 365 Business Premium: cbdc14ab-d96c-4c30-b9f4-6ada7cdc1d46
LICENSE_SKU_ID=05e9a617-0261-4cee-bb44-138d3ef5d965

# ================================================================
# User Provisioning Settings
# ================================================================

# Password profile for new users
# - Auto: Generate random secure password for each user
# - Manual: Use DEFAULT_PASSWORD below (not recommended for production)
USER_PASSWORD_PROFILE=Auto

# Domain suffix for user principal names (e.g., user@domain.com)
# Example: yourdomain.onmicrosoft.com or customdomain.com
USER_DOMAIN=yourdomain.onmicrosoft.com

# Default usage location (ISO 3166-1 alpha-2 country code)
# Required for license assignment. Common values:
# - US (United States)
# - GB (United Kingdom)
# - CA (Canada)
# - AU (Australia)
# - DE (Germany)
# - NO (Norway)
# Can be overridden per user in CSV file
DEFAULT_USAGE_LOCATION=US

# Optional: Default password for all users (only used if USER_PASSWORD_PROFILE=Manual)
# Requirements: Minimum 8 characters, contains uppercase, lowercase, number, and symbol
# DEFAULT_PASSWORD=TempPassword123!

# ================================================================
# Account Protection Settings (CRITICAL SAFETY FEATURE)
# ================================================================

# Protected email patterns (wildcards supported)
# These accounts will NEVER be updated or deleted by the provisioning tool
# Default patterns: admin@*, administrator@*, root@*, systemadmin@*
# Add your own patterns separated by commas
PROTECTED_EMAIL_PATTERNS=admin@*,administrator@*,root@*,systemadmin@*

# Explicit protected emails (exact matches)
# Add specific email addresses that should always be protected
# Example: PROTECTED_EMAILS=admin@domain.com,ceo@domain.com
PROTECTED_EMAILS=

# Check for Azure AD admin roles (Global Administrator, etc.)
# When true, users with admin roles will be automatically protected
# Set to false to disable role-based protection (not recommended)
CHECK_ADMIN_ROLES=true

# Protected Azure AD roles (users with these roles cannot be modified/deleted)
# This is a built-in list, but you can override it if needed
# Default: Global Administrator, Privileged Role Administrator, Security Administrator, etc.

# ================================================================
# Authentication Notes
# ================================================================
# When you run 'npm run provision', the authentication flow will:
#
# 1. Start a local web server on http://localhost:5544
# 2. Automatically open your browser to the authentication page
# 3. Click "Login with Microsoft" button
# 4. Sign in with your Microsoft 365 admin account
# 5. Grant consent to the requested permissions
# 6. Browser will show "Authentication complete"
# 7. CLI will continue automatically
#
# This uses the same MSAL browser pattern as NodeGraphApp_basicAuth.
# No tokens are cached - you'll authenticate each time you run provision.
# ================================================================
